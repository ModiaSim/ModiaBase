<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · ModiaBase</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">ModiaBase</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Release-Notes"><span>Release Notes</span></a></li><li><a class="tocitem" href="#Main-developers"><span>Main developers</span></a></li></ul></li><li><a class="tocitem" href="Tutorial.html">Tutorial</a></li><li><a class="tocitem" href="DataStructures.html">Data Structures</a></li><li><a class="tocitem" href="EquationSorting.html">Equation Sorting</a></li><li><a class="tocitem" href="EquationReduction.html">Equation Reduction</a></li><li><a class="tocitem" href="TransformationToODEs.html">Transformation to ODE System</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ModiaSim/ModiaBase.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ModiaBase.jl-Documentation"><a class="docs-heading-anchor" href="#ModiaBase.jl-Documentation">ModiaBase.jl Documentation</a><a id="ModiaBase.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#ModiaBase.jl-Documentation" title="Permalink"></a></h1><p><a href="https://github.com/ModiaSim/ModiaBase.jl">ModiaBase</a> provides functions to support the transformation of a Differential Algebraic Equation system (DAE)</p><p class="math-container">\[0 = f_{dae}(\frac{dx_{dae}}{dt},x_{dae},w,t) \tag{1}\]</p><p>to an explicit Ordinary Differential Equation system (ODE)</p><p class="math-container">\[\begin{aligned}
  \frac{dx_{ode}}{dt} &amp;= f_{x}(x_{ode},t) \\
         (w, x_{dae}) &amp;= f_{w}(x_{ode},t)
\end{aligned} \tag{2}\]</p><p>where <span>$x=x(t), w=w(t)$</span> are vector valued functions of the scalar variable <span>$t$</span> (= usually time). <span>$x_{dae}$</span> is the DAE state vector, <span>$x_{ode}$</span> is the ODE state vector - a subset of <span>$x_{dae}$</span>, and <span>$w$</span> are purely algebraic variables that do not appear differentiated in the DAE. The equations are hereby represented as a vector of Julia expressions, that is of an Abstract Syntax Tree (AST).</p><p>These functions are used by package <a href="https://github.com/ModiaSim/Modia.jl">Modia</a>, but can also be utilized in another context. Especially the following functionality is provided:</p><ul><li>Simplify linear Integer equations (many equations of object-oriented models are linear Integer equations and can be pre-processed exactly)<ul><li>to remove alias variables and equations,</li><li>to remove redundant equations,</li><li>to provide definite values for variables that can have arbitrary values if this makes sense,</li><li>to make state constraints structurally visible.</li></ul></li><li>Find a variable assignment of an equation system, in order to transform the equation system in a directed graph that can be further processed.</li><li>Find the strong components in a directed graph (with the algorithm of Tarjan) to determine algebraic equation systems that must be solved together.</li></ul><ul><li>Sort an equation system (= transform to Block Lower Triangular form),  to determine the order in which the equations have to be evaluated.</li><li>Reduce the dimension of algebraic equation systems by tearing.</li></ul><ul><li>Find equations that need to be differentiated one or more times (with the algorithm of Pantelides) in order that the DAE can be transformed to an ODE.</li></ul><ul><li>Analytically differentiate the found equations.</li></ul><ul><li>Statically select ODE states and transform to ODE form (hereby identifying linear equation systems that must be solved during simulation).</li></ul><p>Transformation from a DAE to an ODE form is (currently) performed if no nonlinear-algebraic equations appear and the ODE-states can be statically selected.</p><p>Array variables and array equations are kept (they are not &quot;flattened&quot; in single elements). However, DAE forms that require to differentiate array equations, are not yet supported.</p><p>The following extensions are planned (internal prototypes are available):</p><ul><li>Full support of array equations.</li><li>If transformation to an ODE is not possible with the algorithms above, transformation to a special index 1 DAE, that can be simulated with standard DAE solvers (such as Sundials IDA).</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>The package is registered and is installed with (Julia 1.7 is required):</p><pre><code class="language-julia hljs">julia&gt; ]add ModiaBase</code></pre><h2 id="Release-Notes"><a class="docs-heading-anchor" href="#Release-Notes">Release Notes</a><a id="Release-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Release-Notes" title="Permalink"></a></h2><h3 id="Version-0.10.0"><a class="docs-heading-anchor" href="#Version-0.10.0">Version 0.10.0</a><a id="Version-0.10.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.10.0" title="Permalink"></a></h3><p><strong>Non-backwards</strong> compatible changes</p><ul><li>EquationAndStateInfo.jl and StateSelection.jl moved to Modia (ModiaLang is merged into Modia), because the AST generation in these files depends on details of CodeGeneration.jl of Modia/ModiaLang.</li><li>TestLinearEquations.jl also moved to Modia/ModiaLang.</li></ul><h3 id="Version-0.9.2"><a class="docs-heading-anchor" href="#Version-0.9.2">Version 0.9.2</a><a id="Version-0.9.2-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.9.2" title="Permalink"></a></h3><ul><li>Minor (efficiency) improvement of linear equation system if iteration variables are SVectors. </li></ul><h3 id="Version-0.9.1"><a class="docs-heading-anchor" href="#Version-0.9.1">Version 0.9.1</a><a id="Version-0.9.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.9.1" title="Permalink"></a></h3><ul><li>Update of Manifest.toml file</li></ul><h3 id="Version-0.9.0"><a class="docs-heading-anchor" href="#Version-0.9.0">Version 0.9.0</a><a id="Version-0.9.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.9.0" title="Permalink"></a></h3><p>Non-backwards compatible improvements</p><ul><li>Parameter values in the code are now type cast to the type of the parameter value from the  <code>@instantiatedModel(..)</code> call. The benefit is that access of parameter values in the code is type stable and operations with the parameter value are more efficient and at run-time no memory is allocated. Existing models can no longer be simulated, if parameter values provided via <code>simulate!(.., merge=xx)</code> are not type compatible to their definition. For example, an error is thrown if the @instantedModel(..) uses a Float64 value and the <code>simulate!(.., merge=xx)</code> uses a <code>Measurement{Float64}</code> value for the same parameter.</li></ul><p>Other improvements</p><ul><li>Hierarchical names in function calls supported (e.g. <code>a.b.c.fc(..)</code>). </li></ul><ul><li>Functions can return multiple values, e.g. <code>(tau1,tau2) = generalizedForces(derw1, derw2)</code>.</li></ul><ul><li>Large speedup of symbolic transformation, if function depends on many input (and output) arguments  (includes new operator <code>implicitDependency(..)</code>).</li><li>Support for StaticArrays variables (the StaticArrays feature is kept in the generated AST).</li><li>Support for Array variables (especially of state and tearing variables) where the dimension can change after @instantiateModel(..)</li></ul><ul><li>Included DAE-Mode in solution of linear equation system (if DAE integrator is used and all unknowns of a linear equation system are part of the DAE states, solve the linear equation system during continuous integration via DAE solver (= usually large simulation speed-up, for larger linear equation systems)  </li></ul><ul><li>Improved code generation of linear equation systems lead to more efficient solution of linear equation systems.</li></ul><p>Bug fixes</p><ul><li>Do no longer expand the unit macro in the AST, such as <code>u&quot;N&quot;</code>, because otherwise <code>logCode=true</code> results in wrong code (previously, a <code>u&quot;N&quot;</code>  definition in the model was displayed in the code as <code>N</code> which is not correct Julia code).</li></ul><h3 id="Version-0.8.1"><a class="docs-heading-anchor" href="#Version-0.8.1">Version 0.8.1</a><a id="Version-0.8.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.1" title="Permalink"></a></h3><ul><li>Update Project.toml, Manifest.toml, README.md</li></ul><h3 id="Version-0.8.0"><a class="docs-heading-anchor" href="#Version-0.8.0">Version 0.8.0</a><a id="Version-0.8.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.0" title="Permalink"></a></h3><ul><li>Require Julia 1.7</li><li>Upgrade Manifest.toml to version 2.0</li><li>Update Project.toml/Manifest.toml</li></ul><h3 id="Version-0.7.8"><a class="docs-heading-anchor" href="#Version-0.7.8">Version 0.7.8</a><a id="Version-0.7.8-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.8" title="Permalink"></a></h3><ul><li>Tests of TestDifferentiate.jl corrected to comply with DiffRules &gt; 1.0</li><li>Scaling introduced to improve numerics when constructing A-matrix of linear equation system.</li></ul><h3 id="Version-0.7.7"><a class="docs-heading-anchor" href="#Version-0.7.7">Version 0.7.7</a><a id="Version-0.7.7-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.7" title="Permalink"></a></h3><ul><li>Bug fixed when selecting RecursiveFactorization.jl</li></ul><h3 id="Version-0.7.6"><a class="docs-heading-anchor" href="#Version-0.7.6">Version 0.7.6</a><a id="Version-0.7.6-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.6" title="Permalink"></a></h3><ul><li>Fixed bug in StateSelection.jl: If unitless=true, no unit is associated with the tearing variable.</li></ul><ul><li>Solve linear equation systems optionally with <a href="https://github.com/YingboMa/RecursiveFactorization.jl">RecursiveFactorization.jl</a>  instead of the default <code>lu!(..)</code> and <code>ldiv!(..)</code>.</li></ul><ul><li>Project.toml: Changed DiffRules from &quot;~1.0&quot; to &quot;1&quot;, since issue with &quot;1.2.1&quot;  (leading to an error in runtests) seems to be fixed.</li><li>Project.toml: Added version 1 of MonteCarloMeasurements.</li><li>Updated used packages.</li></ul><ul><li>Tutorial slightly improved.</li></ul><h3 id="Version-0.7.5"><a class="docs-heading-anchor" href="#Version-0.7.5">Version 0.7.5</a><a id="Version-0.7.5-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.5" title="Permalink"></a></h3><ul><li>Added a restriction, so that DiffRules 1.0.2 is used, instead of 1.2.1 (which leads to an error in the test suite).</li></ul><h3 id="Version-0.7.4"><a class="docs-heading-anchor" href="#Version-0.7.4">Version 0.7.4</a><a id="Version-0.7.4-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.4" title="Permalink"></a></h3><ul><li>showCodeWithoutComments(code): Bug corrected to only remove comments and not other code (ModiaLang.@instantiateModel(..., logCode=true, ...) gave wrong output).</li><li>Used packages updated</li></ul><h3 id="Version-0.7.3"><a class="docs-heading-anchor" href="#Version-0.7.3">Version 0.7.3</a><a id="Version-0.7.3-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.3" title="Permalink"></a></h3><ul><li>Speed improvements for structural and symbolic algorithms.</li></ul><ul><li>Added support for state events, time events and synchronous operators (positive(), Clock(), after(), pre(), previous(), hold(), initial(), terminal()) </li></ul><ul><li>Added support for mixed linear equation systems having Real and Boolean unknowns.</li></ul><ul><li>Simplified code for linear equation systems (while-loop instead of for-loop).</li></ul><ul><li>Added TimerOutputs @timeit instrumentation to the solution of linear equation systems.</li></ul><h3 id="Version-0.7.2"><a class="docs-heading-anchor" href="#Version-0.7.2">Version 0.7.2</a><a id="Version-0.7.2-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.2" title="Permalink"></a></h3><ul><li>Support of parameters as hierarchical named tuples.</li></ul><ul><li>Support of array comprehensions.</li></ul><ul><li>Support of array end (e.g. A[3:end])</li></ul><ul><li>If one equation cannot be solved for one unknown (e.g. since function call), try to solve it as linear equation system.</li><li>If variables with init values are explicitly solved for, print warning message only if log = true (in TinyModia.simulate! an error occurs, if the init value cannot be respected).</li></ul><h3 id="Version-0.7.1"><a class="docs-heading-anchor" href="#Version-0.7.1">Version 0.7.1</a><a id="Version-0.7.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.1" title="Permalink"></a></h3><ul><li>Due to version conflicts, added version 0.17 of DataStructures in compat.</li></ul><h3 id="Version-0.7.0"><a class="docs-heading-anchor" href="#Version-0.7.0">Version 0.7.0</a><a id="Version-0.7.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.0" title="Permalink"></a></h3><ul><li>Initial version, based on code developed for Modia 0.6 and ModiaMath 0.6.</li></ul><h2 id="Main-developers"><a class="docs-heading-anchor" href="#Main-developers">Main developers</a><a id="Main-developers-1"></a><a class="docs-heading-anchor-permalink" href="#Main-developers" title="Permalink"></a></h2><ul><li><a href="mailto:Hilding.Elmqvist@Mogram.net">Hilding Elmqvist</a>, <a href="http://www.mogram.net/">Mogram</a>.</li></ul><ul><li><a href="https://rmc.dlr.de/sr/en/staff/martin.otter/">Martin Otter</a>, <a href="https://www.dlr.de/sr/en">DLR - Institute of System Dynamics and Control</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="Tutorial.html">Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Tuesday 1 March 2022 00:46">Tuesday 1 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
